'use client'

import { useEffect, useState } from 'react'

// 안전한 localStorage 함수들
const safeSetItem = (key: string, value: string) => {
  try {
    if (typeof value === 'string' && value.length < 1000) {
      localStorage.setItem(key, value)
    }
  } catch (error) {
    console.error('localStorage 저장 실패:', error)
  }
}

const safeGetItem = (key: string): string | null => {
  try {
    return localStorage.getItem(key)
  } catch (error) {
    console.error('localStorage 읽기 실패:', error)
    return null
  }
}

export default function InitialLoading() {
  const [showLoading, setShowLoading] = useState(false)
  const [isFirstVisit, setIsFirstVisit] = useState(false)

  useEffect(() => {
    // 첫 방문 여부 확인
    const hasVisited = safeGetItem('hasVisited')
    
    if (!hasVisited) {
      setIsFirstVisit(true)
      setShowLoading(true)
      
      // 2초 후 로딩 화면 숨김
      const timer = setTimeout(() => {
        setShowLoading(false)
        safeSetItem('hasVisited', 'true')
      }, 2000)
      
      return () => clearTimeout(timer)
    }
  }, [])

  if (!showLoading || !isFirstVisit) {
    return null
  }

  return (
    <div className="fixed inset-0 bg-white z-[9999] flex items-center justify-center">
      <div className="animate-fade-in">
        <svg 
          width="736" 
          height="112" 
          viewBox="0 0 736 112" 
          fill="none" 
          xmlns="http://www.w3.org/2000/svg"
          className="w-[368px] h-[56px] md:w-[736px] md:h-[112px]"
        >
          <path 
            d="M39.9187 110H26.1317L0.726656 30.9963H14.9783L32.9478 94.664H33.2576L49.6779 30.9963H63.7747L80.8147 94.664H81.1245L97.5448 30.9963H111.796L87.1659 110H73.5339L56.8038 47.4167H56.4939L39.9187 110ZM155.081 111.859C147.749 111.859 141.191 110.103 135.408 106.592C129.625 103.081 125.132 98.1753 121.931 91.8756C118.729 85.576 117.129 78.4502 117.129 70.4982C117.129 62.5462 118.729 55.4204 121.931 49.1207C125.132 42.8211 129.625 37.9156 135.408 34.4044C141.191 30.8931 147.749 29.1374 155.081 29.1374C162.517 29.1374 169.127 30.8931 174.91 34.4044C180.796 37.9156 185.392 42.8211 188.697 49.1207C192.001 55.4204 193.654 62.5462 193.654 70.4982C193.654 78.4502 192.001 85.576 188.697 91.8756C185.392 98.1753 180.796 103.081 174.91 106.592C169.127 110.103 162.517 111.859 155.081 111.859ZM155.081 100.241C159.832 100.241 164.066 99.0015 167.784 96.5229C171.502 93.9411 174.393 90.4298 176.459 85.9891C178.628 81.4451 179.712 76.2814 179.712 70.4982C179.712 64.8182 178.628 59.7062 176.459 55.1622C174.393 50.6182 171.502 47.1069 167.784 44.6284C164.066 42.0465 159.832 40.7556 155.081 40.7556C150.434 40.7556 146.303 42.0465 142.689 44.6284C139.074 47.1069 136.234 50.6182 134.169 55.1622C132.103 59.7062 131.071 64.8182 131.071 70.4982C131.071 76.2814 132.052 81.4451 134.014 85.9891C136.079 90.4298 138.919 93.9411 142.534 96.5229C146.252 99.0015 150.434 100.241 155.081 100.241ZM244.372 29.4473C248.71 29.4473 252.686 30.1702 256.3 31.616L254.441 43.544C251.033 41.8916 247.574 41.0654 244.062 41.0654C239.931 41.0654 236.214 42.4596 232.909 45.248C229.604 48.0364 227.022 51.9607 225.163 57.0211C223.304 62.0814 222.375 67.9164 222.375 74.5258V110H209.208V30.9963H221.91V45.8676C226.764 34.9207 234.251 29.4473 244.372 29.4473ZM281.993 70.4982H295.16V83.6655H281.993V110H268.826V0.634168H281.993V70.4982ZM321.495 30.9963H334.662V44.1636H321.495V30.9963ZM308.328 44.1636H321.495V57.3309H308.328V44.1636ZM295.16 70.4982V57.3309H308.328V70.4982H295.16ZM321.495 96.8327H308.328V70.4982H321.495V96.8327ZM334.662 96.8327V110H321.495V96.8327H334.662ZM380.694 111.859C372.02 111.859 364.636 109.948 358.542 106.127C352.553 102.203 348.473 96.4713 346.305 88.9324L359.007 84.44C361.589 94.9738 368.663 100.241 380.23 100.241C386.116 100.241 390.764 99.1564 394.172 96.9876C397.683 94.7156 399.438 91.5658 399.438 87.5382C399.438 84.7498 398.612 82.5811 396.96 81.032C395.308 79.3796 392.932 78.0887 389.834 77.1593C386.736 76.2298 382.089 75.1454 375.892 73.9062C358.026 70.2916 349.093 62.9076 349.093 51.7542C349.093 47.1069 350.436 43.0793 353.121 39.6713C355.909 36.2633 359.575 33.6814 364.119 31.9258C368.766 30.0669 373.775 29.1374 379.145 29.1374C386.684 29.1374 393.242 30.7382 398.819 33.9396C404.396 37.0378 407.958 41.3236 409.508 46.7971L397.115 50.6698C396.392 47.6749 394.533 45.2996 391.538 43.544C388.543 41.6851 384.722 40.7556 380.075 40.7556C374.808 40.7556 370.625 41.7367 367.527 43.6989C364.532 45.5578 363.035 47.9847 363.035 50.9796C363.035 53.2516 363.861 55.1105 365.513 56.5564C367.166 58.0022 369.541 59.2414 372.639 60.2742C375.841 61.2036 380.436 62.3396 386.426 63.6822C392.003 64.9214 396.65 66.3156 400.368 67.8647C404.086 69.3105 407.184 71.5309 409.662 74.5258C412.141 77.5207 413.38 81.4967 413.38 86.4538C413.38 94.4058 410.385 100.654 404.396 105.198C398.406 109.639 390.505 111.859 380.694 111.859ZM460.019 110H446.232L420.827 30.9963H435.078L453.048 94.664H453.358L469.778 30.9963H483.875L500.915 94.664H501.225L517.645 30.9963H531.897L507.266 110H493.634L476.904 47.4167H476.594L460.019 110ZM558.228 16.1251H545.06V0.634168H558.228V16.1251ZM558.228 110H545.06V30.9963H558.228V110ZM601.556 30.9963H627.891V44.1636H601.556V57.3309H588.389V44.1636H575.222V30.9963H588.389V0.634168H601.556V30.9963ZM664.139 44.1636H677.307V70.4982H664.139V57.3309H650.972V0.634168H664.139V44.1636ZM677.307 30.9963H708.908V44.1636H677.307V30.9963ZM708.908 57.3309V44.1636H722.075V57.3309H708.908ZM614.723 57.3309V70.4982H601.556V57.3309H614.723ZM722.075 70.4982V57.3309H735.243V70.4982H722.075ZM588.389 96.8327V70.4982H601.556V96.8327H588.389ZM650.972 70.4982H664.139V110H650.972V70.4982ZM708.908 70.4982H722.075V110H708.908V70.4982ZM627.891 110H601.556V96.8327H627.891V110Z" 
            fill="#000000"
          />
        </svg>
      </div>
    </div>
  )
} 